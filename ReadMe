ğŸ§  Why do all requests log â€œReservedâ€, but only some succeed?

This project intentionally demonstrates a race condition and its fix using Optimistic Locking.

The confusing part

You may notice logs like:

Reserved 1 unit of product P3
Reserved 1 unit of product P3
Reserved 1 unit of product P3


â€¦but in reality, only 1 or 2 orders actually succeed.

This looks wrong â€” but itâ€™s expected behavior.

ğŸš¨ Important concept (in simple words)

Inside a @Transactional method:

save() does NOT immediately update the database

Instead:

Hibernate updates the object in memory

Marks it as â€œchangedâ€

Delays the real database update

So:

inventoryRepository.save(inventory);


means:

â€œIâ€™ll update this later when the transaction finishesâ€

â€”not â€œupdate DB right nowâ€.





